---
title: "Untitled"
author: "Joaquim Aguirre-Plans"
date: "2024-12-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(data.table)
library(dplyr)
```

```{r}
dataset <- "gtex"
type_dataset <- "Whole.Blood"
sizes_selected <- c(20, 100, 200, 300, 400, 500)
sizes_selected_comparison_plot <- c(20, 100, 200, 300)
threshold_selected <- 0.05
```

Fetch the files containing the gene co-expression networks of different sample sizes:

```{r}
coexpression_dir <- sprintf("/scratch/j.aguirreplans/Scipher/SampleSizeProject/networks_%s/reads/%s/consensus", dataset, type_dataset)
all_coexpression_files <- list.files(coexpression_dir)
coexpression_files_selected <- data.frame(matrix(ncol = length(c("size", "file")), nrow = 0, dimnames = list(NULL, c("size", "file"))))

for (coexpression_file in all_coexpression_files){
  file_split <- strsplit(
    gsub(".net", "", coexpression_file),
    split = "_"
  )[[1]]
  size <- as.numeric(file_split[(length(file_split)-1)])
  if (size %in% sizes_selected){
    coexpression_files_selected <- rbind(
      coexpression_files_selected,
      data.frame(
        size = size,
        file = paste(coexpression_dir, coexpression_file, sep = "/")
      )
    )
  }
}
```