###################################
COPY FILES FROM COMPUTER TO CLUSTER
###################################

1. COPY SCRIPTS

scp /Users/quim/Dropbox/Postdoc/Projects/Scipher/SampleSizeEffect/scripts/* discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts

2. COPY DATA FILES

scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/bootstrap discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/bootstrap/responders discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/bootstrap


######################################
CREATE RENV ENVIRONMENT IN THE CLUSTER
######################################

##### CONDA #####

# Install
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load R/4.0.3
module load anaconda3/3.7
conda create -n SampleSizeR r-essentials r-base
source activate SampleSizeR
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
install.packages('devtools')
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
BiocManager::install("WGCNA")
BiocManager::install("minet")
install.packages('optparse')
install.packages('dplyr')
install.packages('RcppEigen')

# Solve problem of Error in if (nzchar(SHLIB_LIBADD)): https://stackoverflow.com/questions/53813323/installing-r-packages-in-macos-mojave-error-in-if-nzcharshlib-libadd 

# There are the following Makeconf files:
find ~ -name Makeconf
/home/j.aguirreplans/.conda/pkgs/r-pbdzmq-0.3_3-r36h5455479_1/lib/R/library/pbdZMQ/etc/Makeconf
/home/j.aguirreplans/.conda/pkgs/r-base-3.6.1-haffb61f_2/lib/R/etc/Makeconf
/home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf
/home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/library/pbdZMQ/etc/Makeconf

# The Makeconf file in /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf is empty, so we substitute it for the one in /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf
mv /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf.backup
cp /home/j.aguirreplans/.conda/pkgs/r-base-3.6.1-haffb61f_2/lib/R/etc/Makeconf /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf

# Load
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load R/4.0.3
module load anaconda3/3.7
source activate SampleSizeR

# Deactivate
conda deactivate


##### PACKRAT #####

# Initialize the project
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load R/4.0.3
cd /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts
mkdir SampleSizeR
R
install.packages("packrat")
packrat::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")

# Install packages
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
install.packages('devtools')
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
install.packages(c('optparse', 'tidyr'))
install.packages('RcppEigen')
install.packages('mltools')
BiocManager::install("WGCNA")
BiocManager::install("minet")
install.packages(c("patchwork", "plotly"))
install.packages("Hmisc")

# Install wto from github
library(devtools)
install_github("deisygysi/wTO") 

# Save changes
packrat::snapshot()

# Close project


##### RENV #####

srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load R/4.0.3
R
install.packages("renv")
renv::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")
renv::install("bioc::BiRewire")
renv::install("RfastOfficial/Rfast")
renv::install("deisygysi/NetSci")
renv::install("optparse")
renv::install("RcppEigen")
renv::install("tidyr")
renv::install("bioc::WGCNA")


install.packages('devtools')
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
install.packages('optparse')
install.packages('dplyr')
install.packages('RcppEigen')
BiocManager::install("WGCNA")

renv::snapshot() # To save the changes in the renv environment

Include this line at the beginning of the R script:
renv::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")

Clear all variables in the environment:
rm(list=ls())

########################################
INSTALL R PACKAGES TO RUN IN THE CLUSTER
########################################

¡¡¡¡¡ This might not be necessary anymore because I can use the renv environment !!!!!

https://thecoatlessprofessor.com/programming/r/working-with-r-on-a-cluster/ 

1. CREATE R_LIBS

mkdir ~/Rlibs

2. LOAD R MODULE

module load R/4.0.3

3. EXPORT R ENVIRONMENT

export R_LIBS=~/Rlibs

4. INSTALL PACKAGES

module load R/4.0.3
R
install.packages('devtools')
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
library(devtools)
install_github('deisygysi/NetSci')
install.packages('optparse')
install.packages('RcppEigen')
BiocManager::install("WGCNA")

All the packages are installed in:

ls /home/j.aguirreplans/R/x86_64-pc-linux-gnu-library/4.0/


#########################
RUN A TEST IN THE CLUSTER
#########################

sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/generate_cn_test.sh
squeue -u j.aguirreplans
sacct


#############################################################
RUN GENERATION OF CO-EXPRESSION NETWORKS USING WTO IN CLUSTER
#############################################################

module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_wto_cluster.py

squeue -u j.aguirreplans
sacct


#######################################################
RUN GENERATION OF CO-EXPRESSION NETWORKS IN THE CLUSTER 
#######################################################

#------#
# GTEx #
#------#

# SAMPLES INPUT DIRS: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition
# RNASEQ INPUT DIRS: /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue
# OUTPUT DIRS: /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads

#---- PEARSON ----#

# MULTIPLE DATASETS - READS
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_for_complete_dataset_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads -m pearson

# Whole.Blood - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Whole.Blood -m pearson
# Whole.Blood - PEARSON - TPM - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/tpm/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Whole.Blood -m pearson

# Breast.Mammary.Tissue - PEARSON - READS - FEMALE
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Breast.Mammary.Tissue_female -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Breast.Mammary.Tissue_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue_female -m pearson
# Breast.Mammary.Tissue - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Breast.Mammary.Tissue -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Breast.Mammary.Tissue.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue -m pearson
# Breast.Mammary.Tissue - PEARSON - TPM - FEMALE
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Breast.Mammary.Tissue_female -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/tpm/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Breast.Mammary.Tissue_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Breast.Mammary.Tissue_female -m pearson

# Artery.Tibial - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Artery.Tibial -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Artery.Tibial.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Artery.Tibial -m pearson
# Artery.Tibial - PEARSON - TPM - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Artery.Tibial -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/tpm/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Artery.Tibial.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Artery.Tibial -m pearson

# Muscle.Skeletal - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Muscle.Skeletal.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Muscle.Skeletal -m pearson

# Skin.Sun.Exposed.Lower.leg - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Skin.Sun.Exposed.Lower.leg -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Skin.Sun.Exposed.Lower.leg.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Skin.Sun.Exposed.Lower.leg -m pearson

# Thyroid - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Thyroid -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Thyroid.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Thyroid -m pearson

# Adipose.Subcutaneous - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Adipose.Subcutaneous -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Adipose.Subcutaneous.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Adipose.Subcutaneous -m pearson

# Nerve.Tibial - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Nerve.Tibial -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Nerve.Tibial.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Nerve.Tibial -m pearson

# Skin.Not.Sun.Exposed.Suprapubic - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Skin.Not.Sun.Exposed.Suprapubic -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Skin.Not.Sun.Exposed.Suprapubic.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Skin.Not.Sun.Exposed.Suprapubic -m pearson

# Lung - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Lung -r /work/ccnr/j.aguirreplans/Databases/GTEx/v8/reads/rnaseq_filtered_files_by_tissue/gtex_rnaseq_Lung.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Lung -m pearson



#---------#
# SCIPHER #
#---------#

# SAMPLES INPUT DIRS: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/scipher.complete.dataset
# RNASEQ INPUT DIRS: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/rnaseq_filtered_files_by_group/scipher_rnaseq_scipher.complete.dataset.csv
# OUTPUT DIRS: /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.dataset

#---- PEARSON ----#

# scipher.complete.dataset - PEARSON - READS 
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/scipher.complete.dataset -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/rnaseq_filtered_files_by_group/scipher_rnaseq_scipher.complete.dataset.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.dataset -m pearson

# scipher.complete.nonresponder - PEARSON - READS 
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/scipher.complete.nonresponder -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/rnaseq_filtered_files_by_group/scipher_rnaseq_scipher.complete.nonresponder.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.nonresponder -m pearson

# scipher.complete.responder - PEARSON - READS 
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/scipher.complete.responder -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/rnaseq_filtered_files_by_group/scipher_rnaseq_scipher.complete.responder.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.responder -m pearson

# scipher.sample.per.patient.baseline - PEARSON - READS 
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/scipher.sample.per.patient.baseline -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/rnaseq_filtered_files_by_group/scipher_rnaseq_scipher.sample.per.patient.baseline.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.sample.per.patient.baseline -m pearson



#------#
# TCGA #
#------#

# SAMPLES INPUT DIRS: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-BRCA
# RNASEQ INPUT DIRS: /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-BRCA.csv
# OUTPUT DIRS: /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor

#---- PEARSON ----#

# MULTIPLE DATASETS - READS
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_for_complete_dataset_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor -m pearson

# TCGA - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/tcga_rnaseq_TCGA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA -m pearson

# TCGA-BRCA (Breast Cancer) - PEARSON - READS - FEMALE
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-BRCA_female -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-BRCA_female.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA_female -m pearson
# TCGA-BRCA (Breast Cancer) - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-BRCA -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-BRCA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA -m pearson

# TCGA-COAD (Colon Cancer) - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-COAD -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-COAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-COAD -m pearson

# TCGA-UCEC - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-UCEC -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-UCEC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-UCEC -m pearson

# TCGA-KIRC - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-KIRC -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-KIRC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-KIRC -m pearson

# TCGA-LUAD - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-LUAD -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LUAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-LUAD -m pearson

# TCGA-LGG - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-LGG -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LGG.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-LGG -m pearson

# TCGA-THCA - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-THCA -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-THCA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-THCA -m pearson

# TCGA-LUSC - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-LUSC -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LUSC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-LUSC -m pearson

# TCGA-HNSC - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-HNSC -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-HNSC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-HNSC -m pearson

# TCGA-PRAD - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-PRAD -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-PRAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-PRAD -m pearson

# TCGA-SKCM - PEARSON - READS - BOTH SEX
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-07-27-Dataset/sampling_with_repetition/tumor/TCGA-SKCM -r /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/reads/tumor/filter_genes_low_counts/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-SKCM.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-SKCM -m pearson



######################################################
ANALYSIS OF GENE CO-EXPRESSION NETWORKS IN THE CLUSTER
######################################################

# GTEx: All genes - Whole.Blood (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Whole.Blood -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Whole.Blood.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Whole.Blood -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Whole.Blood
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Whole.Blood
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Whole.Blood

# GTEx: All genes - Muscle.Skeletal (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Muscle.Skeletal -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Muscle.Skeletal.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Muscle.Skeletal -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Muscle.Skeletal
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Muscle.Skeletal
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Muscle.Skeletal

# GTEx: All genes - Skin.Sun.Exposed.Lower.leg (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Skin.Sun.Exposed.Lower.leg -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Skin.Sun.Exposed.Lower.leg.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Skin.Sun.Exposed.Lower.leg -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Skin.Sun.Exposed.Lower.leg
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Skin.Sun.Exposed.Lower.leg
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Skin.Sun.Exposed.Lower.leg

# GTEx: All genes - Thyroid (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Thyroid -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Thyroid.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Thyroid -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Thyroid
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Thyroid
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Thyroid

# GTEx: All genes - Artery.Tibial (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Artery.Tibial -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Artery.Tibial.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Artery.Tibial -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Artery.Tibial
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Artery.Tibial
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Artery.Tibial

# GTEx: All genes - Adipose.Subcutaneous (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Adipose.Subcutaneous -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Adipose.Subcutaneous.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Adipose.Subcutaneous -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Adipose.Subcutaneous
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Adipose.Subcutaneous
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Adipose.Subcutaneous

# GTEx: All genes - Nerve.Tibial (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Nerve.Tibial -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Nerve.Tibial.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Nerve.Tibial -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Nerve.Tibial
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Nerve.Tibial
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Nerve.Tibial

# GTEx: All genes - Skin.Not.Sun.Exposed.Suprapubic (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Skin.Not.Sun.Exposed.Suprapubic -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Skin.Not.Sun.Exposed.Suprapubic.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Skin.Not.Sun.Exposed.Suprapubic -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Skin.Not.Sun.Exposed.Suprapubic
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Skin.Not.Sun.Exposed.Suprapubic
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Skin.Not.Sun.Exposed.Suprapubic

# GTEx: All genes - Lung (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/tpm/Lung -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /work/ccnr/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Lung.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Lung -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Lung
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/tpm/Lung
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/tpm/Lung


#### SCIPHER ####

# complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_scipher.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_scipher.csv -g /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_gene_info.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_scipher/reads/complete.dataset -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_scipher/reads/complete.dataset
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_scipher/reads/complete.dataset
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_scipher/reads/complete.dataset


#### TCGA (GDC) ####

# ALL (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/tpm/TCGA -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/rnaseq_gene_info_filter_genes_low_counts.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA

# TCGA-BRCA (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-BRCA -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-BRCA.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-BRCA -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-BRCA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-BRCA
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-BRCA

# TCGA-LGG (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-LGG -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-LGG.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LGG -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LGG
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LGG
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LGG

# TCGA-THCA (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-THCA -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-THCA.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-THCA -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-THCA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-THCA
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-THCA

# TCGA-LUSC (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-LUSC -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-LUSC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LUSC -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LUSC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LUSC
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LUSC

# TCGA-COAD (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-COAD -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-COAD.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-COAD -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-COAD
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-COAD
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-COAD

# TCGA-LUAD (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-LUAD -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-LUAD.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LUAD -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LUAD
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-LUAD
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-LUAD

# TCGA-PRAD (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-PRAD -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-PRAD.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-PRAD -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-PRAD
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-PRAD
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-PRAD

# TCGA-HNSC (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-HNSC -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-HNSC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-HNSC -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-HNSC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-HNSC
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-HNSC

# TCGA-SKCM (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-SKCM -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-SKCM.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-SKCM -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-SKCM
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-SKCM
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-SKCM

# TCGA-UCEC (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-UCEC -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-UCEC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-UCEC -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-UCEC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-UCEC
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-UCEC

# TCGA-KIRC (TPM)
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/tpm/tumor/TCGA-KIRC -p /work/ccnr/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /work/ccnr/j.aguirreplans/Databases/TCGA/2022-07-27-Dataset/TCGA/out/tumor/filter_genes_low_counts/genes_filtered_files_by_project/rnaseq_gene_info_TCGA-KIRC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-KIRC -n /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-KIRC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/tpm/tumor/TCGA-KIRC
# output networks: /work/ccnr/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/tpm/tumor/TCGA-KIRC

# Copy results
scp -r discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/plots_N100 /Users/quim/Desktop

###################################
DIFFERENTIAL CO-EXPRESSION ANALYSIS
###################################

# TCGA-BRCA_female vs. GTEx: Breast.Mammary.Tissue_female
-d /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA_female
-n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue_female
-o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/TCGA-BRCA_female___Breast.Mammary.Tissue_female
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/calculate_differentially_coexpressed_genes_cluster.py -d /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA_female -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue_female -o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/TCGA-BRCA_female___Breast.Mammary.Tissue_female -p 0.05 -s -f

# TCGA-BRCA vs. GTEx: Breast.Mammary.Tissue
-d /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA
-n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue
-o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/TCGA-BRCA___Breast.Mammary.Tissue
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/calculate_differentially_coexpressed_genes_cluster.py -d /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/reads/tumor/TCGA-BRCA -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Breast.Mammary.Tissue -o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/TCGA-BRCA___Breast.Mammary.Tissue -p 0.05 -s -f

# Scipher: complete dataset vs. GTEx: Whole.Blood
-d /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.dataset
-n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Whole.Blood
-o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/scipher.complete.dataset___Whole.Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/calculate_differentially_coexpressed_genes_cluster.py -d /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.dataset -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Whole.Blood -o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/scipher.complete.dataset___Whole.Blood -p 0.05 -s -f

# Scipher: complete non-responder vs. GTEx: Whole.Blood
-d /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.nonresponder
-n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Whole.Blood
-o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/scipher.complete.nonresponder___Whole.Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/calculate_differentially_coexpressed_genes_cluster.py -d /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/reads/scipher.complete.nonresponder -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/reads/Whole.Blood -o /scratch/j.aguirreplans/Scipher/SampleSize/differential_coexpression_analysis/reads/scipher.complete.nonresponder___Whole.Blood -p 0.05 -s -f


############################
ANALYSIS OF INDIVIDUAL EDGES
############################

sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/merge_networks.sh
sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analysis_individual_edges.sh

######################################
ANALYSIS DISEASE GENES VS. SAMPLE SIZE
######################################

Download data from COVID-19 project: https://github.com/Barabasi-Lab/COVID-19/blob/main/data/Guney2016_GenesDisease.tsv
Download data from Entrez to Gene symbol: https://ftp.ncbi.nih.gov/gene/DATA/GENE_INFO/Mammalia/
Download data from MeSH (mtrees2021.bin): https://nlmpubs.nlm.nih.gov/projects/mesh/MESH_FILES/meshtrees/ 

Transfer data to the cluster:
scp /Users/quim/Dropbox/References/Gysi_PNAS21_Supplementary/Guney2016_GenesDisease.tsv discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp /Users/quim/Documents/DATA/BioGroup/Scipher/data/Homo_sapiens.gene_info discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp /Users/quim/Documents/Databases/MeSH/mtrees2021.bin discovery:/work/ccnr/j.aguirreplans/Databases/MeSH

How to plot it?
---------------
- Group diseases by disease type: for example, first branch of MeSH.
- Make a plot for each group of diseases and check which diseases are more representative of each group.
- Choose the most representative diseases of each group and make a plot of it.
- Get the genes of all diseases of each group to make another plot.

#########
SHINY APP
#########

Run shiny app:

module load R/4.0.3
R
setwd('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts')
shiny::runApp(SampleSizeShiny)

or
shiny::runApp('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeShiny')

Deploy Shiny app:
-----------------

STEP 1 - INSTALL RSCONNECT
install.packages('rsconnect')

STEP 2 - AUTHORIZE ACCOUNT
rsconnect::setAccountInfo(name='joaquimaguirreplans',
			  token='4DC11654508D7B2460595CBBB4C28FA4',
			  secret='1PW1nxzeiXCoWMwLDV7al1iT/QSwgdTMHTilLlII')

STEP 3 - DEPLOY
library(rsconnect)
rsconnect::deployApp('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeShiny')


###################################
ANALYSIS USING RA DATASET FROM ENZO
###################################

Download data from: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE97810

- Non normalized data: GSE97810_non-normalized_baseline.txt.gz
- Soft formatted family file: GSE97810_family.soft

Transfer data to the cluster:
scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/RA discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data

Run script to import data:
sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/data/RA/scripts/data_import_GSE97810.sh


################
CLUSTER COMMANDS
################

squeue -u j.aguirreplans
sacct
sacct -ojobid,jobname,state,nodelist

Check memory (WTO):
seff 21612351
Job ID: 21612351
Cluster: discovery
User/Group: j.aguirreplans/users
State: COMPLETED (exit code 0)
Cores: 1
CPU Utilized: 04:47:25
CPU Efficiency: 99.95% of 04:47:33 core-walltime
Job Wall-clock time: 04:47:33
Memory Utilized: 32.21 GB
Memory Efficiency: 32.98% of 97.66 GB

seff 21612312
Job ID: 21612312
Cluster: discovery
User/Group: j.aguirreplans/users
State: COMPLETED (exit code 0)
Cores: 1
CPU Utilized: 09:10:24
CPU Efficiency: 99.99% of 09:10:26 core-walltime
Job Wall-clock time: 09:10:26
Memory Utilized: 33.96 GB
Memory Efficiency: 34.77% of 97.66 GB

Job failed because of memory:
Job ID: 21623791
Cluster: discovery
User/Group: j.aguirreplans/users
State: FAILED (exit code 1)
Cores: 1
CPU Utilized: 15:48:46
CPU Efficiency: 99.79% of 15:50:47 core-walltime
Job Wall-clock time: 15:50:47
Memory Utilized: 31.67 GB
Memory Efficiency: 81.08% of 39.06 GB


#################################
TRANSFER FILES OUT OF THE CLUSTER
#################################

Network files:

sshfs j.aguirreplans@xfer.discovery.neu.edu:/work/ccnr/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100/* /System/Volumes/Data/Volumes/QUIM/DATA/Scipher/SampleSize/networks_nonresponders_wto_N100

Scripts:

scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\* /Users/j.aguirreplans/Dropbox/Postdoc/Projects/Scipher/SampleSize/scripts/
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\*.html /Users/j.aguirreplans/Desktop/results_GTEx
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\*.html /Users/quim/Desktop/results_GTEx

Results:

scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/GTEx_analysis/\* /Users/j.aguirreplans/Desktop/results_GTEx
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/GTEx_analysis/\* /Users/quim/Desktop/results_GTEx


#########################################
CREATE VIRTUAL ENVIRONMENT IN THE CLUSTER
#########################################

Create conda environment:
https://rc-docs.northeastern.edu/en/latest/software/conda.html#creating-python 

srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load anaconda3/3.7
conda create -n ScipherSampleSizeEnv
source activate ScipherSampleSizeEnv

Run conda environment using OnDemand:
https://rc-docs.northeastern.edu/en/latest/using-ood/interactiveapps.html

To install NetworkMedicineToolbox, I just cloned the repository in the scripts directory.
To update NetworkMedicineToolbox, I just have to:
cd /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/NetworkMedicineToolbox
git pull origin master

Install modules:
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load anaconda3/3.7
source activate ScipherSampleSizeEnv
pip install GEOparse

To use the function girvan_newman of networkx, there was an incompatibility with the package decorator, it required a version of decorator lower than 5. So I have downgraded it:
source activate ScipherSampleSizeEnv
pip install --upgrade decorator==4.3


#######
VS CODE
#######

What to do if I cannot get access to Discovery using VS CODE?

I have to remove the folder /home/j.aguirreplans/.vscode-server
The problem is that sometimes I get messages such as the following:

$ rm -r *
rm: cannot remove ‘74b1f979648cc44d385a2286793c226e611f59e7/.nfs000000091aa2050100000d75’: Device or resource busy
rm: cannot remove ‘74b1f979648cc44d385a2286793c226e611f59e7/node_modules/spdlog/build/Release/.nfs0000000919d4d39a00001595’: Device or resource busy
rm: cannot remove ‘74b1f979648cc44d385a2286793c226e611f59e7/node_modules/vsda/build/Release/.nfs000000091a2df78400001596’: Device or resource busy
rm: cannot remove ‘74b1f979648cc44d385a2286793c226e611f59e7/bin/.nfs000000091a7f35ca00001597’: Device or resource busy

This means that there are still jobs in the cluster using the files in the folder .vscode-server.
So, I have to identify these jobs and kill them.
To identify the jobs, I can run the following command:

$ lsof +D .vs-code-server/
COMMAND    PID           USER   FD   TYPE DEVICE SIZE/OFF        NODE NAME
sh       45729 j.aguirreplans   98w   REG   0,40        0 39096268426 ./784b0177c56c607789f9638da7b6bf3230d47a8c/.nfs000000091a51b68a00000956
sh       45729 j.aguirreplans   99w   REG   0,40        0 39088069321 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/.nfs0000000919d49ac90000099c
sh       45729 j.aguirreplans  255r   REG   0,40      249 39088976497 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/bin/.nfs0000000919e272710000158e
node     45745 j.aguirreplans  txt    REG   0,40 80316256 39082497796 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/.nfs00000009197f97040000158f
node     45745 j.aguirreplans  mem    REG   0,40    38336 39088976556 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/node_modules/vsda/build/Release/.nfs0000000919e272ac0000158d
node     45745 j.aguirreplans  mem    REG   0,40   571088 39057542056 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/node_modules/spdlog/build/Release/.nfs000000091802cba80000158c
node     45745 j.aguirreplans   98w   REG   0,40        0 39096268426 ./784b0177c56c607789f9638da7b6bf3230d47a8c/.nfs000000091a51b68a00000956
node     45745 j.aguirreplans   99w   REG   0,40        0 39088069321 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/.nfs0000000919d49ac90000099c
node     45850 j.aguirreplans  txt    REG   0,40 80316256 39082497796 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/.nfs00000009197f97040000158f
node     45850 j.aguirreplans  mem    REG   0,40   571088 39057542056 ./e7f30e38c5a4efafeec8ad52861eb772a9ee4dfb/node_modules/spdlog/build/Release/.nfs000000091802cba80000158c
node     45850 j.aguirreplans   98w   REG   0,40        0 39096268426 ./784b0177c56c607789f9638da7b6bf3230d47a8c/.nfs000000091a51b68a00000956

Then, kill the jobs using their PID:
$ kill -9 45745

Finally, I can remove the folder:

$ rm -r .vscode-server/


#############
UPDATE GITHUB
#############

# I don't know why it only works in the login node, not in the other ones
# Go to the folder
cd /home/j.aguirreplans/Projects/Scipher/SampleSize

# To add new changes:
git add --all .
git commit -m "Calculate networks for Scipher"
git push origin master

# To pull changes from the repository:
git pull origin

# Get personal token to authentificate for 2 factor authentification (in case it has expired):
Go to Github > Settings > Developer Settings > Personal access tokens
Token: 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


