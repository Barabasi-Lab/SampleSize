###################################
COPY FILES FROM COMPUTER TO CLUSTER
###################################

1. COPY SCRIPTS

scp /Users/quim/Dropbox/Postdoc/Projects/Scipher/SampleSizeEffect/scripts/* discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts

2. COPY DATA FILES

scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/bootstrap discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/bootstrap/responders discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/bootstrap


######################################
CREATE RENV ENVIRONMENT IN THE CLUSTER
######################################

##### CONDA #####

# Install
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load R/4.0.3
module load anaconda3/3.7
conda create -n SampleSizeR r-essentials r-base
source activate SampleSizeR
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
install.packages('devtools')
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
BiocManager::install("WGCNA")
BiocManager::install("minet")
install.packages('optparse')
install.packages('dplyr')
install.packages('RcppEigen')

# Solve problem of Error in if (nzchar(SHLIB_LIBADD)): https://stackoverflow.com/questions/53813323/installing-r-packages-in-macos-mojave-error-in-if-nzcharshlib-libadd 

# There are the following Makeconf files:
find ~ -name Makeconf
/home/j.aguirreplans/.conda/pkgs/r-pbdzmq-0.3_3-r36h5455479_1/lib/R/library/pbdZMQ/etc/Makeconf
/home/j.aguirreplans/.conda/pkgs/r-base-3.6.1-haffb61f_2/lib/R/etc/Makeconf
/home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf
/home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/library/pbdZMQ/etc/Makeconf

# The Makeconf file in /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf is empty, so we substitute it for the one in /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf
mv /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf.backup
cp /home/j.aguirreplans/.conda/pkgs/r-base-3.6.1-haffb61f_2/lib/R/etc/Makeconf /home/j.aguirreplans/.conda/envs/SampleSizeR/lib/R/etc/Makeconf

# Load
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load R/4.0.3
module load anaconda3/3.7
source activate SampleSizeR

# Deactivate
conda deactivate


##### PACKRAT #####

# Initialize the project
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load R/4.0.3
cd /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts
mkdir SampleSizeR
R
install.packages("packrat")
packrat::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")

# Install packages
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
install.packages('devtools')
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
install.packages(c('optparse', 'tidyr'))
install.packages('RcppEigen')
install.packages('mltools')
BiocManager::install("WGCNA")
BiocManager::install("minet")
install.packages(c("patchwork", "plotly"))
install.packages("Hmisc")

# Install wto from github
library(devtools)
install_github("deisygysi/wTO") 

# Save changes
packrat::snapshot()

# Close project


##### RENV #####

srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load R/4.0.3
R
install.packages("renv")
renv::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")
renv::install("bioc::BiRewire")
renv::install("RfastOfficial/Rfast")
renv::install("deisygysi/NetSci")
renv::install("optparse")
renv::install("RcppEigen")
renv::install("tidyr")
renv::install("bioc::WGCNA")


install.packages('devtools')
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("BiRewire")
devtools::install_github('RfastOfficial/Rfast')
devtools::install_github('deisygysi/NetSci')
install.packages('optparse')
install.packages('dplyr')
install.packages('RcppEigen')
BiocManager::install("WGCNA")

renv::snapshot() # To save the changes in the renv environment

Include this line at the beginning of the R script:
renv::init("/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeR")

Clear all variables in the environment:
rm(list=ls())

########################################
INSTALL R PACKAGES TO RUN IN THE CLUSTER
########################################

¡¡¡¡¡ This might not be necessary anymore because I can use the renv environment !!!!!

https://thecoatlessprofessor.com/programming/r/working-with-r-on-a-cluster/ 

1. CREATE R_LIBS

mkdir ~/Rlibs

2. LOAD R MODULE

module load R/4.0.3

3. EXPORT R ENVIRONMENT

export R_LIBS=~/Rlibs

4. INSTALL PACKAGES

module load R/4.0.3
R
install.packages('devtools')
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
library(devtools)
install_github('deisygysi/NetSci')
install.packages('optparse')
install.packages('RcppEigen')
BiocManager::install("WGCNA")

All the packages are installed in:

ls /home/j.aguirreplans/R/x86_64-pc-linux-gnu-library/4.0/


#########################
RUN A TEST IN THE CLUSTER
#########################

sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/generate_cn_test.sh
squeue -u j.aguirreplans
sacct


#############################################################
RUN GENERATION OF CO-EXPRESSION NETWORKS USING WTO IN CLUSTER
#############################################################

module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_wto_cluster.py

squeue -u j.aguirreplans
sacct


#######################################################################
RUN GENERATION OF CO-EXPRESSION NETWORKS USING OTHER METRICS IN CLUSTER
#######################################################################

module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/bootstrap/nonresponders -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -m wto
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/bootstrap/responders -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -m wto
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -m wgcna
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -m pearson
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -m spearman

python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/bootstrap/nonresponders -o /scratch/j.aguirreplans/Scipher/SampleSize/example_wto -m wto

# Using samples files
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Liver -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Liver -m wto

#### GTEx ####

# WTO CONVERGENCE: All genes - Muscle.Skeletal - Female
module load python/3.8.1
# For the moment only 20 to try how much time do they take (2021/12/16, 17:14)
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_with_wto_finding_pvalue_convergence_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_female

# WTO FASTER: All genes - Muscle.Skeletal
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_female -m wto
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_male -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_male.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_male -m wto

# WTO FASTER: All genes - Whole blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -m wto

# WGCNA: All genes - Muscle.Skeletal
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_female -m wgcna
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_male -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_male.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_male -m wgcna

# WGCNA: All genes - Whole Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood_female -m wgcna
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood_male -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood_male.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood_male -m wgcna
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -m wgcna

# Pearson: All samples - Whole Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -m pearson

# Pearson: All samples - Muscle.Skeletal
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Muscle.Skeletal.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal -m pearson

# Pearson: All samples - Skin.Sun.Exposed.Lower.leg
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Skin.Sun.Exposed.Lower.leg -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Skin.Sun.Exposed.Lower.leg.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Skin.Sun.Exposed.Lower.leg -m pearson

# Pearson: All samples - Thyroid
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Thyroid -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Thyroid.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Thyroid -m pearson

# Pearson: All samples - Artery.Tibial
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Artery.Tibial -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Artery.Tibial.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Artery.Tibial -m pearson

# Pearson: All samples - Adipose.Subcutaneous
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Adipose.Subcutaneous -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Adipose.Subcutaneous.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Adipose.Subcutaneous -m pearson

# Pearson: All samples - Nerve.Tibial
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Nerve.Tibial -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Nerve.Tibial.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Nerve.Tibial -m pearson

# Pearson: All samples - Skin.Not.Sun.Exposed.Suprapubic
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Skin.Not.Sun.Exposed.Suprapubic -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Skin.Not.Sun.Exposed.Suprapubic.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Skin.Not.Sun.Exposed.Suprapubic -m pearson

# Pearson: All samples - Lung
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Lung -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Lung.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Lung -m pearson

# Spearman: All samples - Whole Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -m spearman

# ARACNE: All genes - Muscle.Skeletal
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_female -m aracne
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Muscle.Skeletal_male -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/GTEx_RNASeq_Muscle.Skeletal_male.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal_male -m aracne

# ARACNE: All genes - Whole Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood_female -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood_female.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood_female -m aracne
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood_male -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood_male.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood_male -m aracne
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/GTEx/sampling_with_repetition/Whole.Blood -r /home/j.aguirreplans/Databases/GTEx/v8/tpm_filtered_files_by_tissue/gtex_rnaseq_Whole.Blood.gct -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -m aracne

#### SCIPHER ####

# WTO FASTER: complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/complete.dataset -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -m wto

# Spearman: complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/complete.dataset -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -m spearman
# Spearman: sample.per.patient.all.visits
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/sample.per.patient.all.visits -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_unique_patients_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/sample.per.patient.all.visits -m spearman
# Spearman: sample.per.patient.baseline
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/sample.per.patient.baseline -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_unique_patients_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/sample.per.patient.baseline -m spearman
# Spearman: responder.baseline
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/responder.baseline -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_unique_patients_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/responder.baseline -m spearman
# Spearman: nonresponder.baseline
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/nonresponder.baseline -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_unique_patients_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/nonresponder.baseline -m spearman

# Pearson: complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/complete.dataset -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -m pearson

# ARACNE: complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/Scipher/Dec2021/sampling_with_repetition/complete.dataset -r /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_counts_processed.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -m aracne

#### TCGA (GDC) ####

# Pearson: All samples
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/TCGA_processed_for_coexpression.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA -m pearson
# Spearman: All samples
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/TCGA_processed_for_coexpression.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA -m spearman
# ARACNE: All samples
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/TCGA_processed_for_coexpression.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA -m aracne

# Pearson: TCGA-BRCA
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-BRCA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-BRCA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-BRCA -m pearson
# Spearman: TCGA-BRCA
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-BRCA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-BRCA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-BRCA -m spearman

# Pearson: TCGA-UCEC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-UCEC -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-UCEC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-UCEC -m pearson
# Spearman: TCGA-UCEC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-UCEC -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-UCEC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-UCEC -m spearman

# Pearson: TCGA-KIRC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-KIRC -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-KIRC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-KIRC -m pearson

# Pearson: TCGA-LUAD
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-LUAD -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LUAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LUAD -m pearson

# Pearson: TCGA-LGG
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-LGG -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LGG.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LGG -m pearson

# Pearson: TCGA-THCA
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-THCA -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-THCA.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-THCA -m pearson

# Pearson: TCGA-LUSC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-LUSC -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-LUSC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LUSC -m pearson

# Pearson: TCGA-HNSC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-HNSC -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-HNSC.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-HNSC -m pearson

# Pearson: TCGA-PRAD
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-PRAD -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-PRAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-PRAD -m pearson

# Pearson: TCGA-SKCM
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-SKCM -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-SKCM.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-SKCM -m pearson

# Pearson: TCGA-COAD
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/create_gene_coexpression_networks_from_samples_cluster.py -i /home/j.aguirreplans/Projects/Scipher/SampleSize/data/sampling/TCGA/2022-03-28-Dataset/sampling_with_repetition/TCGA-COAD -r /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/rnaseq_filtered_files_by_project/tcga_rnaseq_TCGA-COAD.csv -o /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-COAD -m pearson


squeue -u j.aguirreplans
sacct
sacct -ojobid,jobname,state,nodelist

Check memory (WTO):
seff 21612351
Job ID: 21612351
Cluster: discovery
User/Group: j.aguirreplans/users
State: COMPLETED (exit code 0)
Cores: 1
CPU Utilized: 04:47:25
CPU Efficiency: 99.95% of 04:47:33 core-walltime
Job Wall-clock time: 04:47:33
Memory Utilized: 32.21 GB
Memory Efficiency: 32.98% of 97.66 GB

seff 21612312
Job ID: 21612312
Cluster: discovery
User/Group: j.aguirreplans/users
State: COMPLETED (exit code 0)
Cores: 1
CPU Utilized: 09:10:24
CPU Efficiency: 99.99% of 09:10:26 core-walltime
Job Wall-clock time: 09:10:26
Memory Utilized: 33.96 GB
Memory Efficiency: 34.77% of 97.66 GB

Job failed because of memory:
Job ID: 21623791
Cluster: discovery
User/Group: j.aguirreplans/users
State: FAILED (exit code 1)
Cores: 1
CPU Utilized: 15:48:46
CPU Efficiency: 99.79% of 15:50:47 core-walltime
Job Wall-clock time: 15:50:47
Memory Utilized: 31.67 GB
Memory Efficiency: 81.08% of 39.06 GB

#################################
TRANSFER FILES OUT OF THE CLUSTER
#################################

Network files:

sshfs j.aguirreplans@xfer.discovery.neu.edu:/scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100/* /System/Volumes/Data/Volumes/QUIM/DATA/Scipher/SampleSize/networks_nonresponders_wto_N100

Scripts:

scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\* /Users/j.aguirreplans/Dropbox/Postdoc/Projects/Scipher/SampleSize/scripts/
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\*.html /Users/j.aguirreplans/Desktop/results_GTEx
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/\*.html /Users/quim/Desktop/results_GTEx

Results:

scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/GTEx_analysis/\* /Users/j.aguirreplans/Desktop/results_GTEx
scp discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/GTEx_analysis/\* /Users/quim/Desktop/results_GTEx


#########################################
CREATE VIRTUAL ENVIRONMENT IN THE CLUSTER
#########################################

Create conda environment:
https://rc-docs.northeastern.edu/en/latest/software/conda.html#creating-python 

srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load anaconda3/3.7
conda create -n ScipherSampleSizeEnv
source activate ScipherSampleSizeEnv

Run conda environment using OnDemand:
https://rc-docs.northeastern.edu/en/latest/using-ood/interactiveapps.html

To install NetworkMedicineToolbox, I just cloned the repository in the scripts directory.
To update NetworkMedicineToolbox, I just have to:
cd /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/NetworkMedicineToolbox
git pull origin master

Install modules:
srun --partition=short --nodes=1 --cpus-per-task=1 --time=24:00:00 --pty /bin/bash
module load python/3.8.1
module load anaconda3/3.7
source activate ScipherSampleSizeEnv
pip install GEOparse

To use the function girvan_newman of networkx, there was an incompatibility with the package decorator, it required a version of decorator lower than 5. So I have downgraded it:
source activate ScipherSampleSizeEnv
pip install --upgrade decorator==4.3

######################################################
ANALYSIS OF GENE CO-EXPRESSION NETWORKS IN THE CLUSTER
######################################################


# 10,000 genes, NONRESPONDERS, N20, pvals 0.05, 0.01, 0.001
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N50 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_sample_size
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_G10000_N20 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_sample_size_G10000_N20_pval_0.05 -p 0.05
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_G10000_N20 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_sample_size_G10000_N20_pval_0.01 -p 0.01
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_G10000_N20 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_sample_size_G10000_N20_pval_0.001 -p 0.001

# All genes, NONRESPONDERS, N100, pvals 0.05, 0.01, top 100
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.05_top_100 -p 0.05
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.01_top_100 -p 0.01

# All genes, NONRESPONDERS, N100, pvals 0.01, 0.05, tops 0.1, 0.5, 1
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.01_top_0.1 -p 0.01 -t 0.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.01_top_0.5 -p 0.01 -t 0.5
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.01_top_1 -p 0.01 -t 1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.05_top_0.1 -p 0.05 -t 0.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.05_top_0.5 -p 0.05 -t 0.5
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_nonresponders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_nonresponders_wto_N100_pval_0.05_top_1 -p 0.05 -t 1

# All genes, RESPONDERS, N100, pvals 0.01, 0.05, tops 0.1, 0.5, 1
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.01_top_0.1 -p 0.01 -t 0.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.01_top_0.5 -p 0.01 -t 0.5
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.01_top_1 -p 0.01 -t 1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.05_top_0.1 -p 0.05 -t 0.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.05_top_0.5 -p 0.05 -t 0.5
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_by_size_cluster.py -n /scratch/j.aguirreplans/Scipher/SampleSize/networks_responders_wto_N100 -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_responders_wto_N100_pval_0.05_top_1 -p 0.05 -t 1


# GTEx: All genes - Whole.Blood
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Whole.Blood -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Whole.Blood.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Whole.Blood -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Whole.Blood
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Whole.Blood
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Whole.Blood

# GTEx: All genes - Muscle.Skeletal
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Muscle.Skeletal -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Muscle.Skeletal.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Muscle.Skeletal -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Muscle.Skeletal
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Muscle.Skeletal
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Muscle.Skeletal

# GTEx: All genes - Skin.Sun.Exposed.Lower.leg
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Skin.Sun.Exposed.Lower.leg -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Skin.Sun.Exposed.Lower.leg.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Skin.Sun.Exposed.Lower.leg -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Skin.Sun.Exposed.Lower.leg
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Skin.Sun.Exposed.Lower.leg
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Skin.Sun.Exposed.Lower.leg

# GTEx: All genes - Thyroid
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Thyroid -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Thyroid.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Thyroid -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Thyroid
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Thyroid
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Thyroid

# GTEx: All genes - Artery.Tibial
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Artery.Tibial -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Artery.Tibial.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Artery.Tibial -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Artery.Tibial
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Artery.Tibial
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Artery.Tibial

# GTEx: All genes - Adipose.Subcutaneous
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Adipose.Subcutaneous -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Adipose.Subcutaneous.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Adipose.Subcutaneous -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Adipose.Subcutaneous
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Adipose.Subcutaneous
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Adipose.Subcutaneous

# GTEx: All genes - Nerve.Tibial
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Nerve.Tibial -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Nerve.Tibial.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Nerve.Tibial -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Nerve.Tibial
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Nerve.Tibial
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Nerve.Tibial

# GTEx: All genes - Skin.Not.Sun.Exposed.Suprapubic
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Skin.Not.Sun.Exposed.Suprapubic -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Skin.Not.Sun.Exposed.Suprapubic.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Skin.Not.Sun.Exposed.Suprapubic -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Skin.Not.Sun.Exposed.Suprapubic
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Skin.Not.Sun.Exposed.Suprapubic
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Skin.Not.Sun.Exposed.Suprapubic

# GTEx: All genes - Lung
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_gtex/Lung -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_gtex.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_gtex.csv -g /home/j.aguirreplans/Databases/GTEx/v8/genes_filtered_files_by_tissue/gtex_rnaseq_gene_info_Lung.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Lung -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Lung
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_gtex/Lung
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_gtex/Lung


#### SCIPHER ####

# complete.dataset
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_scipher/complete.dataset -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_scipher.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_scipher.csv -g /home/j.aguirreplans/Projects/Scipher/SampleSize/data/Dec2021/00_data/scipher_rnaseq_gene_info.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_scipher/complete.dataset -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_scipher/complete.dataset
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_scipher/complete.dataset
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_scipher/complete.dataset


#### TCGA (GDC) ####

# ALL
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA

# TCGA-BRCA
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-BRCA -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-BRCA.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-BRCA -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-BRCA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-BRCA
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-BRCA

# TCGA-UCEC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-UCEC -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-UCEC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-UCEC -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-UCEC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-UCEC
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-UCEC

# TCGA-KIRC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-KIRC -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-KIRC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-KIRC -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-KIRC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-KIRC
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-KIRC

# TCGA-LGG
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LGG -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-LGG.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LGG -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LGG
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LGG
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LGG

# TCGA-LUAD
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LUAD -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-LUAD.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LUAD -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LUAD
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LUAD
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LUAD

# TCGA-LUSC
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-LUSC -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-LUSC.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LUSC -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LUSC
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-LUSC
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-LUSC

# TCGA-THCA
module load python/3.8.1
python /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analyze_gene_coexpression_networks_cluster.py -i /scratch/j.aguirreplans/Scipher/SampleSize/networks_tcga/TCGA-THCA -p /home/j.aguirreplans/data/PPI/interactome_2019_merged_symbols.csv -d /home/j.aguirreplans/Projects/Scipher/SampleSize/data/disease_genes/disease_genes_info_2022_tcga.csv -e /home/j.aguirreplans/Projects/Scipher/SampleSize/data/essential_genes/OGEE_essential_genes_tcga.csv -g /home/j.aguirreplans/Databases/TCGA/2022-03-28-Dataset/TCGA/out/genes_filtered_files_by_project/tcga_rnaseq_gene_info_TCGA-THCA.csv -o /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-THCA -n /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-THCA
# output analysis: /home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/analysis_tcga/TCGA-THCA
# output networks: /scratch/j.aguirreplans/Scipher/SampleSize/subgraphs_tcga/TCGA-THCA

# Copy results
scp -r discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data/out/plots_N100 /Users/quim/Desktop

############################
ANALYSIS OF INDIVIDUAL EDGES
############################

sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/merge_networks.sh
sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/analysis_individual_edges.sh

######################################
ANALYSIS DISEASE GENES VS. SAMPLE SIZE
######################################

Download data from COVID-19 project: https://github.com/Barabasi-Lab/COVID-19/blob/main/data/Guney2016_GenesDisease.tsv
Download data from Entrez to Gene symbol: https://ftp.ncbi.nih.gov/gene/DATA/GENE_INFO/Mammalia/
Download data from MeSH (mtrees2021.bin): https://nlmpubs.nlm.nih.gov/projects/mesh/MESH_FILES/meshtrees/ 

Transfer data to the cluster:
scp /Users/quim/Dropbox/References/Gysi_PNAS21_Supplementary/Guney2016_GenesDisease.tsv discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp /Users/quim/Documents/DATA/BioGroup/Scipher/data/Homo_sapiens.gene_info discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data
scp /Users/quim/Documents/Databases/MeSH/mtrees2021.bin discovery:/home/j.aguirreplans/Databases/MeSH

How to plot it?
---------------
- Group diseases by disease type: for example, first branch of MeSH.
- Make a plot for each group of diseases and check which diseases are more representative of each group.
- Choose the most representative diseases of each group and make a plot of it.
- Get the genes of all diseases of each group to make another plot.

#########
SHINY APP
#########

Run shiny app:

module load R/4.0.3
R
setwd('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts')
shiny::runApp(SampleSizeShiny)

or
shiny::runApp('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeShiny')

Deploy Shiny app:
-----------------

STEP 1 - INSTALL RSCONNECT
install.packages('rsconnect')

STEP 2 - AUTHORIZE ACCOUNT
rsconnect::setAccountInfo(name='joaquimaguirreplans',
			  token='4DC11654508D7B2460595CBBB4C28FA4',
			  secret='1PW1nxzeiXCoWMwLDV7al1iT/QSwgdTMHTilLlII')

STEP 3 - DEPLOY
library(rsconnect)
rsconnect::deployApp('/home/j.aguirreplans/Projects/Scipher/SampleSize/scripts/SampleSizeShiny')

###################################
ANALYSIS USING RA DATASET FROM ENZO
###################################

Download data from: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE97810

- Non normalized data: GSE97810_non-normalized_baseline.txt.gz
- Soft formatted family file: GSE97810_family.soft

Transfer data to the cluster:
scp -r /Users/quim/Documents/DATA/BioGroup/Scipher/data/RA discovery:/home/j.aguirreplans/Projects/Scipher/SampleSize/data

Run script to import data:
sbatch /home/j.aguirreplans/Projects/Scipher/SampleSize/data/RA/scripts/data_import_GSE97810.sh



#############
UPDATE GITHUB
#############

# I don't know why it only works in the login node, not in the other ones
# Go to the folder
cd /home/j.aguirreplans/Projects/Scipher/SampleSize

# To add new changes:
git add .
git commit -m "Calculate networks for Scipher"
git push origin

# To pull changes from the repository:
git pull origin

# Get personal token to authentificate for 2 factor authentification (in case it has expired):
Go to Github > Settings > Developer Settings > Personal access tokens
Token: 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


